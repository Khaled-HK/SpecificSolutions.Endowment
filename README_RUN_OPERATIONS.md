# دليل تشغيل عمليات قاعدة البيانات الليبية
## Libyan Database Operations Guide

هذا الدليل يوضح كيفية تشغيل عمليات حذف البيانات القديمة وإدراج البيانات الليبية الجديدة.

---

## 📋 المتطلبات المسبقة

### ✅ قاعدة البيانات
- **SQL Server** مثبت ويعمل
- قاعدة البيانات **`Swagger_Endowment22`** موجودة
- صلاحيات كاملة للقراءة والكتابة

### ✅ الأدوات المطلوبة
- **SQL Server Management Studio (SSMS)** للتنفيذ اليدوي
- أو **sqlcmd** للتنفيذ من سطر الأوامر
- أو أي أداة مدعومة لـ SQL Server

---

## 🚀 طرق التشغيل

### 📌 الطريقة 1: التشغيل التلقائي (مُوصى بها)

#### على نظام Windows:
```batch
# تشغيل مباشر
run_libyan_data_import.bat

# أو من Command Prompt
cmd /c run_libyan_data_import.bat
```

#### على أنظمة Linux/Mac:
```bash
# إعطاء صلاحية التنفيذ أولاً
chmod +x run_libyan_data_import.sh

# تشغيل
./run_libyan_data_import.sh
```

### 📌 الطريقة 2: التنفيذ اليدوي

#### من خلال SQL Server Management Studio:
1. افتح **SSMS**
2. اتصل بـ SQL Server
3. اختر قاعدة البيانات `Swagger_Endowment22`
4. افتح ملف `run_database_operations.sql`
5. اضغط **Execute** (F5)

#### من سطر الأوامر:
```bash
# SQL Server
sqlcmd -S server_name -d Swagger_Endowment22 -i run_database_operations.sql -o output.log

# MySQL (إذا كنت تستخدم MySQL)
mysql -u username -p -D Swagger_Endowment22 < run_database_operations.sql

# PostgreSQL (إذا كنت تستخدم PostgreSQL)
psql -d Swagger_Endowment22 -f run_database_operations.sql
```

---

## 📁 الملفات المطلوبة

| الملف | الوصف |
|-------|---------|
| `run_database_operations.sql` | الملف الرئيسي لعمليات قاعدة البيانات |
| `run_libyan_data_import.bat` | تشغيل تلقائي للويندوز |
| `run_libyan_data_import.sh` | تشغيل تلقائي للـ Linux/Mac |
| `output.log` | ملف السجل (يُنشأ تلقائياً) |

---

## ⚙️ ما يحدث عند التشغيل

### 🗑️ الخطوة الأولى: تنظيف قاعدة البيانات
```sql
-- تعطيل القيود مؤقتاً
-- حذف جميع البيانات من كل الجداول
-- إعادة تفعيل القيود
```

### ➕ الخطوة الثانية: إدراج البيانات الليبية
- **10 بنوك ليبية** (مصرف الجمهورية، البنك التجاري الوطني، إلخ)
- **5 مدن رئيسية** (طرابلس، بنغازي، مصراتة، الزاوية، سبها)
- **5 مناطق ليبية** مرتبطة بالمدن
- **5 منتجات إسلامية** (مصاحف، كتب فقه مالكي، إلخ)
- **5 مكاتب أوقاف** ليبية
- **5 مرافق تعليمية** (مراكز تحفيظ، معاهد، إلخ)
- **5 مباني/مساجد** ليبية
- **5 حسابات مستفيدين** ليبيين
- **5 قرارات إدارية** متنوعة

---

## 📊 البيانات المدرجة

### 🏦 البنوك الليبية
- مصرف الجمهورية
- البنك التجاري الوطني
- مصرف الوحدة
- البنك الأهلي الليبي
- مصرف الصحاري

### 🏙️ المدن والمناطق
- **طرابلس** → منطقة الدهماني
- **بنغازي** → منطقة الصابري
- **مصراتة** → منطقة قصر أحمد
- **الزاوية** → المدينة القديمة
- **سبها** → منطقة الصالحين

### 🕌 المساجد الليبية
- جامع طرابلس الكبير
- مسجد الصحابة
- جامع الشهداء
- مسجد عمر بن الخطاب
- جامع الفاتح

### 👥 الحسابات الليبية
- أحمد محمد الطرابلسي
- فاطمة عبدالرحمن البنغازي
- محمد سعد المصراتي
- عائشة خالد الزاوي
- عبدالله فهد الفزاني

---

## ✅ التحقق من النجاح

### 📋 علامات النجاح:
- رسالة **"تم بنجاح إدراج البيانات الليبية!"**
- ظهور تقرير إحصائي بعدد السجلات
- ملف `output.log` يحتوي على رسائل نجاح

### 🔍 استعلامات للتحقق:
```sql
-- عدد البنوك
SELECT COUNT(*) FROM Banks;

-- عدد المدن الليبية
SELECT COUNT(*) FROM Cities WHERE Country = N'ليبيا';

-- عدد المساجد
SELECT COUNT(*) FROM Mosques;

-- الحسابات الليبية
SELECT Name, City, Country FROM Accounts WHERE Country = N'ليبيا';
```

---

## ❌ حل المشاكل الشائعة

### 🔧 "sqlcmd is not recognized"
**الحل:**
- ثبت **SQL Server Command Line Utilities**
- أو استخدم **SQL Server Management Studio**

### 🔧 "Database does not exist"
**الحل:**
```sql
-- إنشاء قاعدة البيانات
CREATE DATABASE Swagger_Endowment22;
```

### 🔧 "Login failed"
**الحل:**
- تحقق من اسم المستخدم وكلمة المرور
- تأكد من صلاحيات الوصول
- استخدم Windows Authentication

### 🔧 "Foreign key constraint error"
**الحل:**
- تأكد من إنشاء جميع الجداول المطلوبة أولاً
- الملف يتعامل مع هذا تلقائياً بتعطيل القيود

### 🔧 "Arabic text appears as question marks"
**الحل:**
```sql
-- تأكد من إعداد Collation الصحيح
ALTER DATABASE Swagger_Endowment22 
COLLATE Arabic_CI_AS;
```

---

## 🔄 إعادة التشغيل

يمكنك تشغيل العملية عدة مرات:
- **سيتم حذف** البيانات الموجودة أولاً
- **ثم إدراج** البيانات الليبية الجديدة
- **لا مشكلة** في التشغيل المتكرر

---

## 📞 الدعم والمساعدة

### 📧 في حالة وجود مشاكل:
1. راجع ملف `output.log`
2. تحقق من رسائل الخطأ
3. تأكد من متطلبات النظام
4. جرب التشغيل اليدوي في SSMS

### 🛠️ تخصيص الإعدادات:
يمكنك تعديل:
- اسم السيرفر في ملفات `.bat` و `.sh`
- اسم قاعدة البيانات
- بيانات الاتصال

---

## 💰 معلومات مالية

- **العملة**: جميع المبالغ بالدينار الليبي (LYD)
- **أرقام الهواتف**: تنسيق ليبي صحيح
- **العناوين**: مواقع ليبية حقيقية

---

## 🎯 النتيجة المتوقعة

بعد التشغيل الناجح:
- ✅ قاعدة بيانات نظيفة
- ✅ بيانات ليبية أصيلة 
- ✅ علاقات صحيحة بين الجداول
- ✅ ترميز عربي سليم
- ✅ جاهزة للاختبار والتطوير

---

**📝 ملاحظة**: هذه بيانات تجريبية لأغراض التطوير والاختبار فقط.

---

*تم إنشاؤه بعناية لمشروع الأوقاف الليبية* 🇱🇾