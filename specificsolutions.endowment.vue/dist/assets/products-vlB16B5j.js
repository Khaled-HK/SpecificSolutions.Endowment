import{$ as U}from"./api-D2VAfvSL.js";import{V as w}from"./VCardText-CHjIAOK-.js";import{V as M}from"./VSpacer-l9Klvjqs.js";import{a$ as W,r as u,w as A,G as X,f as Y,o as Z,e as t,b as a,d as g,ac as v,t as i,v as S}from"./index-CQOsXohI.js";import{V as _}from"./VDivider-B1a3eLTd.js";import{V as E,a as f}from"./VRow-Di6O-Zre.js";import{V as y}from"./VTextField-Bk6OkpzA.js";import{V as h}from"./VDataTable-DGlm1K1G.js";import{V as L}from"./VChip-CbTZJ7Mz.js";import{V as z}from"./VDialog-CXgvLjIh.js";import{V as $,b as B,d as N}from"./VCard-B42G7FkW.js";import{V as F}from"./VContainer-BYIjP75K.js";import{V as G}from"./VTextarea-kCAOu1kl.js";import{V as ee}from"./VSnackbar-6-2EgsFR.js";import"./index-9rIf2CJL.js";/* empty css              */import"./VAvatar-BgRuPZqv.js";import"./VImg-CjcyiK0z.js";/* empty css                   */import"./VCounter-BmsZrRzg.js";import"./VField-CWid5B0b.js";import"./form-rsUoYxls.js";import"./easing-CjukEv2V.js";import"./VInput-BryTGDRX.js";import"./forwardRefs-C-GTDzx5.js";import"./VPagination-CP9GmUdg.js";import"./VSelect-BHCwQIP7.js";import"./VList-CCWaJaqk.js";import"./ssrBoot-DfkThJM5.js";import"./dialog-transition-BpGH2eC2.js";import"./VMenu-o9zaMFRJ.js";import"./VOverlay-Cl76A974.js";import"./delay-CZ8DLIM0.js";import"./lazy-D412PrL0.js";import"./scopeId-BW6PxMi-.js";import"./VCheckboxBtn-DvA5YR1a.js";import"./VSelectionControl-BdF6Jdch.js";import"./VTable-yJXMcnHj.js";import"./filter-C5y4cIRA.js";import"./VSlideGroup-oeO9Bnc9.js";const Oe=W({__name:"products",setup(le){const D=u([]),T=u(!1),C=u(0),n=u(!1),d=u(""),m=u("success"),b=u(!1),P=u(!1),k=u(!1),x=u(null),R=u([]),q=u(""),s=u({name:"",description:"",price:0,quantity:0}),r=u({id:0,key:"",value:"",name:"",description:"",price:0,quantity:0}),p=u({page:1,itemsPerPage:10,sortBy:[""],sortDesc:[!1]}),I=[{title:"اسم المادة",key:"name"},{title:"الوصف",key:"description"},{title:"السعر",key:"price"},{title:"الكمية",key:"quantity"},{title:"الإجراءات",key:"actions",sortable:!1}],V=async()=>{T.value=!0;try{const o=new URLSearchParams({PageNumber:p.value.page.toString(),PageSize:p.value.itemsPerPage.toString(),SearchTerm:q.value||""}),e=await U(`/Product/filter?${o}`);if(D.value=e.data.items||[],e.data){C.value=e.data.totalCount||0;const l=Math.ceil(C.value/p.value.itemsPerPage);p.value.page>l&&l>0&&(p.value.page=l,await V())}}catch(o){console.error("Error loading products:",o),d.value="حدث خطأ أثناء تحميل المواد",m.value="error",n.value=!0,D.value=[],C.value=0}finally{T.value=!1}},O=async()=>{var o,e;try{const l=await U("/Product",{method:"POST",body:{name:s.value.name,description:s.value.description,price:s.value.price,quantity:s.value.quantity}});if(l&&l.isSuccess===!1){const c=l.message||((e=(o=l.errors)==null?void 0:o[0])==null?void 0:e.errorMessage)||"حدث خطأ أثناء إضافة المادة";d.value=c,m.value="error",n.value=!0;return}b.value=!1,Q(),V(),d.value="تم إضافة المادة بنجاح",m.value="success",n.value=!0}catch(l){console.error("Error adding product:",l),d.value="حدث خطأ أثناء إضافة المادة",m.value="error",n.value=!0}},j=async()=>{var o,e;try{const l=await U(`/Product/${r.value.id}`,{method:"PUT",body:{id:r.value.id,name:r.value.name,description:r.value.description,price:r.value.price,quantity:r.value.quantity}});if(l&&l.isSuccess===!1){const c=l.message||((e=(o=l.errors)==null?void 0:o[0])==null?void 0:e.errorMessage)||"حدث خطأ أثناء تحديث المادة";d.value=c,m.value="error",n.value=!0;return}P.value=!1,V(),d.value="تم تحديث المادة بنجاح",m.value="success",n.value=!0}catch(l){console.error("Error updating product:",l),d.value="حدث خطأ أثناء تحديث المادة",m.value="error",n.value=!0}},H=async()=>{var o,e;if(x.value)try{const l=await U(`/Product/${x.value.id}`,{method:"DELETE"});if(l&&l.isSuccess===!1){const c=l.message||((e=(o=l.errors)==null?void 0:o[0])==null?void 0:e.errorMessage)||"حدث خطأ أثناء حذف المادة";d.value=c,m.value="error",n.value=!0;return}k.value=!1,x.value=null,V(),d.value="تم حذف المادة بنجاح",m.value="success",n.value=!0}catch(l){console.error("Error deleting product:",l),d.value="حدث خطأ أثناء حذف المادة",m.value="error",n.value=!0}},J=o=>{r.value={...o},P.value=!0},K=o=>{x.value=o,k.value=!0},Q=()=>{s.value={name:"",description:"",price:0,quantity:0}};return A(p,()=>{V()},{deep:!0}),A(q,()=>{p.value.page=1,V()}),X(()=>{V()}),(o,e)=>(Z(),Y($,null,{default:t(()=>[a(w,{class:"d-flex align-center flex-wrap gap-4"},{default:t(()=>[e[20]||(e[20]=g("div",{class:"me-3"},[g("h4",{class:"text-h4"}," إدارة المواد "),g("p",{class:"mb-0"}," عرض وإدارة المواد في النظام ")],-1)),a(M),a(v,{"prepend-icon":"tabler-plus",onClick:e[0]||(e[0]=l=>b.value=!0)},{default:t(()=>e[19]||(e[19]=[i(" إضافة مادة جديدة ")])),_:1})]),_:1}),a(_),a(w,null,{default:t(()=>[a(E,null,{default:t(()=>[a(f,{cols:"12",sm:"4"},{default:t(()=>[a(y,{modelValue:q.value,"onUpdate:modelValue":e[1]||(e[1]=l=>q.value=l),"prepend-inner-icon":"tabler-search",label:"البحث في المواد","single-line":"","hide-details":"",density:"compact"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),a(h,{modelValue:R.value,"onUpdate:modelValue":e[2]||(e[2]=l=>R.value=l),headers:I,items:D.value,loading:T.value,"items-per-page":p.value.itemsPerPage,page:p.value.page,total:C.value,class:"text-no-wrap","onUpdate:options":e[3]||(e[3]=l=>p.value=l)},{"item.price":t(({item:l})=>[a(L,{color:l.price>0?"success":"warning",size:"small"},{default:t(()=>[i(S(l.price||0)+" ريال ",1)]),_:2},1032,["color"])]),"item.quantity":t(({item:l})=>[a(L,{color:l.quantity>0?"primary":"error",size:"small"},{default:t(()=>[i(S(l.quantity||0),1)]),_:2},1032,["color"])]),"item.actions":t(({item:l})=>[a(v,{icon:"tabler-edit",variant:"text",size:"small",color:"primary",onClick:c=>J(l)},null,8,["onClick"]),a(v,{icon:"tabler-trash",variant:"text",size:"small",color:"error",onClick:c=>K(l)},null,8,["onClick"])]),_:1},8,["modelValue","items","loading","items-per-page","page","total"]),a(z,{modelValue:b.value,"onUpdate:modelValue":e[9]||(e[9]=l=>b.value=l),"max-width":"500px"},{default:t(()=>[a($,null,{default:t(()=>[a(B,null,{default:t(()=>e[21]||(e[21]=[g("span",{class:"text-h5"},"إضافة مادة جديدة",-1)])),_:1}),a(w,null,{default:t(()=>[a(F,null,{default:t(()=>[a(E,null,{default:t(()=>[a(f,{cols:"12"},{default:t(()=>[a(y,{modelValue:s.value.name,"onUpdate:modelValue":e[4]||(e[4]=l=>s.value.name=l),label:"اسم المادة",required:""},null,8,["modelValue"])]),_:1}),a(f,{cols:"12"},{default:t(()=>[a(G,{modelValue:s.value.description,"onUpdate:modelValue":e[5]||(e[5]=l=>s.value.description=l),label:"الوصف",rows:"3"},null,8,["modelValue"])]),_:1}),a(f,{cols:"6"},{default:t(()=>[a(y,{modelValue:s.value.price,"onUpdate:modelValue":e[6]||(e[6]=l=>s.value.price=l),modelModifiers:{number:!0},label:"السعر",type:"number",min:"0",step:"0.01"},null,8,["modelValue"])]),_:1}),a(f,{cols:"6"},{default:t(()=>[a(y,{modelValue:s.value.quantity,"onUpdate:modelValue":e[7]||(e[7]=l=>s.value.quantity=l),modelModifiers:{number:!0},label:"الكمية",type:"number",min:"0"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),a(N,null,{default:t(()=>[a(M),a(v,{color:"blue-darken-1",variant:"text",onClick:e[8]||(e[8]=l=>b.value=!1)},{default:t(()=>e[22]||(e[22]=[i(" إلغاء ")])),_:1}),a(v,{color:"blue-darken-1",onClick:O},{default:t(()=>e[23]||(e[23]=[i(" إضافة ")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(z,{modelValue:P.value,"onUpdate:modelValue":e[15]||(e[15]=l=>P.value=l),"max-width":"500px"},{default:t(()=>[a($,null,{default:t(()=>[a(B,null,{default:t(()=>e[24]||(e[24]=[g("span",{class:"text-h5"},"تعديل المادة",-1)])),_:1}),a(w,null,{default:t(()=>[a(F,null,{default:t(()=>[a(E,null,{default:t(()=>[a(f,{cols:"12"},{default:t(()=>[a(y,{modelValue:r.value.name,"onUpdate:modelValue":e[10]||(e[10]=l=>r.value.name=l),label:"اسم المادة",required:""},null,8,["modelValue"])]),_:1}),a(f,{cols:"12"},{default:t(()=>[a(G,{modelValue:r.value.description,"onUpdate:modelValue":e[11]||(e[11]=l=>r.value.description=l),label:"الوصف",rows:"3"},null,8,["modelValue"])]),_:1}),a(f,{cols:"6"},{default:t(()=>[a(y,{modelValue:r.value.price,"onUpdate:modelValue":e[12]||(e[12]=l=>r.value.price=l),modelModifiers:{number:!0},label:"السعر",type:"number",min:"0",step:"0.01"},null,8,["modelValue"])]),_:1}),a(f,{cols:"6"},{default:t(()=>[a(y,{modelValue:r.value.quantity,"onUpdate:modelValue":e[13]||(e[13]=l=>r.value.quantity=l),modelModifiers:{number:!0},label:"الكمية",type:"number",min:"0"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),a(N,null,{default:t(()=>[a(M),a(v,{color:"blue-darken-1",variant:"text",onClick:e[14]||(e[14]=l=>P.value=!1)},{default:t(()=>e[25]||(e[25]=[i(" إلغاء ")])),_:1}),a(v,{color:"blue-darken-1",onClick:j},{default:t(()=>e[26]||(e[26]=[i(" تحديث ")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(z,{modelValue:k.value,"onUpdate:modelValue":e[17]||(e[17]=l=>k.value=l),"max-width":"400px"},{default:t(()=>[a($,null,{default:t(()=>[a(B,{class:"text-h5"},{default:t(()=>e[27]||(e[27]=[i(" تأكيد الحذف ")])),_:1}),a(w,null,{default:t(()=>{var l;return[i(' هل أنت متأكد من حذف المادة "'+S((l=x.value)==null?void 0:l.name)+'"؟ ',1),e[28]||(e[28]=g("br",null,null,-1)),e[29]||(e[29]=g("strong",null,"لا يمكن التراجع عن هذا الإجراء.",-1))]}),_:1}),a(N,null,{default:t(()=>[a(M),a(v,{color:"blue-darken-1",variant:"text",onClick:e[16]||(e[16]=l=>k.value=!1)},{default:t(()=>e[30]||(e[30]=[i(" إلغاء ")])),_:1}),a(v,{color:"error",onClick:H},{default:t(()=>e[31]||(e[31]=[i(" حذف ")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(ee,{modelValue:n.value,"onUpdate:modelValue":e[18]||(e[18]=l=>n.value=l),color:m.value,timeout:3e3},{default:t(()=>[i(S(d.value),1)]),_:1},8,["modelValue","color"])]),_:1}))}});export{Oe as default};
