import{$ as U}from"./api-Yee635Cw.js";import{V as w}from"./VCardText-D3qn0xVt.js";import{V as M}from"./VSpacer-DK1R1B3V.js";import{aZ as Q,r as u,w as A,D as W,f as X,o as Y,e as t,b as a,d as g,aa as v,s as i,t as D}from"./index-B2yH2wlm.js";import{V as _}from"./VDivider-IJOr89EA.js";import{V as E,a as f}from"./VRow-D_lBkBiQ.js";import{V as y}from"./VTextField-Bsi5YaIU.js";import{V as h}from"./VDataTable-xmUF_rxc.js";import{V as L}from"./VChip-zFsRdrE0.js";import{V as z}from"./VDialog-B5IthHHF.js";import{V as S,b as B,d as N}from"./VCard-CbXeyWRM.js";import{V as F}from"./VContainer-Cjj3jwcN.js";import{V as I}from"./VTextarea-BOmbQ_dF.js";import{V as ee}from"./VSnackbar-DYOt6puD.js";import"./index-9rIf2CJL.js";/* empty css              */import"./VAvatar-CShMG6gm.js";import"./VImg-LCEu9fG5.js";/* empty css                   */import"./VCounter-D0OrblNh.js";import"./VField-BS4jWEZX.js";import"./form-CrJ5wAnD.js";import"./easing-CjukEv2V.js";import"./VInput-BBUwaJU8.js";import"./forwardRefs-C-GTDzx5.js";import"./VPagination-D22GyUdV.js";import"./VSelect-Djzs4lEs.js";import"./VList-BP_s4Rd6.js";import"./ssrBoot-BM3_9gcl.js";import"./dialog-transition-B1F2T2U2.js";import"./VMenu-sVHB4BSf.js";import"./VOverlay-DatZLL7h.js";import"./delay-D2xRnafG.js";import"./lazy-CIM2OltQ.js";import"./scopeId-Bz1iMFsM.js";import"./VCheckboxBtn-BIPGNd9w.js";import"./VSelectionControl-BRBkIS9Q.js";import"./VTable-BeF_b8U_.js";import"./filter-CiRrM1UE.js";import"./VSlideGroup-xF0vztaY.js";const Ze=Q({__name:"products",setup(le){const T=u([]),$=u(!1),C=u(0),n=u(!1),d=u(""),m=u("success"),b=u(!1),P=u(!1),k=u(!1),x=u(null),R=u([]),q=u(""),s=u({name:"",description:"",price:0,quantity:0}),r=u({id:0,key:"",value:"",name:"",description:"",price:0,quantity:0}),p=u({page:1,itemsPerPage:10,sortBy:[""],sortDesc:[!1]}),O=[{title:"اسم المادة",key:"name"},{title:"الوصف",key:"description"},{title:"السعر",key:"price"},{title:"الكمية",key:"quantity"},{title:"الإجراءات",key:"actions",sortable:!1}],V=async()=>{$.value=!0;try{const o=new URLSearchParams({PageNumber:p.value.page.toString(),PageSize:p.value.itemsPerPage.toString(),SearchTerm:q.value||""}),e=await U(`/Product/filter?${o}`);if(T.value=e.data.items||[],e.data){C.value=e.data.totalCount||0;const l=Math.ceil(C.value/p.value.itemsPerPage);p.value.page>l&&l>0&&(p.value.page=l,await V())}}catch(o){console.error("Error loading products:",o),d.value="حدث خطأ أثناء تحميل المواد",m.value="error",n.value=!0,T.value=[],C.value=0}finally{$.value=!1}},Z=async()=>{var o,e;try{const l=await U("/Product",{method:"POST",body:{name:s.value.name,description:s.value.description,price:s.value.price,quantity:s.value.quantity}});if(l&&l.isSuccess===!1){const c=l.message||((e=(o=l.errors)==null?void 0:o[0])==null?void 0:e.errorMessage)||"حدث خطأ أثناء إضافة المادة";d.value=c,m.value="error",n.value=!0;return}b.value=!1,K(),V(),d.value="تم إضافة المادة بنجاح",m.value="success",n.value=!0}catch(l){console.error("Error adding product:",l),d.value="حدث خطأ أثناء إضافة المادة",m.value="error",n.value=!0}},j=async()=>{var o,e;try{const l=await U(`/Product/${r.value.id}`,{method:"PUT",body:{id:r.value.id,name:r.value.name,description:r.value.description,price:r.value.price,quantity:r.value.quantity}});if(l&&l.isSuccess===!1){const c=l.message||((e=(o=l.errors)==null?void 0:o[0])==null?void 0:e.errorMessage)||"حدث خطأ أثناء تحديث المادة";d.value=c,m.value="error",n.value=!0;return}P.value=!1,V(),d.value="تم تحديث المادة بنجاح",m.value="success",n.value=!0}catch(l){console.error("Error updating product:",l),d.value="حدث خطأ أثناء تحديث المادة",m.value="error",n.value=!0}},G=async()=>{var o,e;if(x.value)try{const l=await U(`/Product/${x.value.id}`,{method:"DELETE"});if(l&&l.isSuccess===!1){const c=l.message||((e=(o=l.errors)==null?void 0:o[0])==null?void 0:e.errorMessage)||"حدث خطأ أثناء حذف المادة";d.value=c,m.value="error",n.value=!0;return}k.value=!1,x.value=null,V(),d.value="تم حذف المادة بنجاح",m.value="success",n.value=!0}catch(l){console.error("Error deleting product:",l),d.value="حدث خطأ أثناء حذف المادة",m.value="error",n.value=!0}},H=o=>{r.value={...o},P.value=!0},J=o=>{x.value=o,k.value=!0},K=()=>{s.value={name:"",description:"",price:0,quantity:0}};return A(p,()=>{V()},{deep:!0}),A(q,()=>{p.value.page=1,V()}),W(()=>{V()}),(o,e)=>(Y(),X(S,null,{default:t(()=>[a(w,{class:"d-flex align-center flex-wrap gap-4"},{default:t(()=>[e[20]||(e[20]=g("div",{class:"me-3"},[g("h4",{class:"text-h4"}," إدارة المواد "),g("p",{class:"mb-0"}," عرض وإدارة المواد في النظام ")],-1)),a(M),a(v,{"prepend-icon":"tabler-plus",onClick:e[0]||(e[0]=l=>b.value=!0)},{default:t(()=>e[19]||(e[19]=[i(" إضافة مادة جديدة ")])),_:1})]),_:1}),a(_),a(w,null,{default:t(()=>[a(E,null,{default:t(()=>[a(f,{cols:"12",sm:"4"},{default:t(()=>[a(y,{modelValue:q.value,"onUpdate:modelValue":e[1]||(e[1]=l=>q.value=l),"prepend-inner-icon":"tabler-search",label:"البحث في المواد","single-line":"","hide-details":"",density:"compact"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),a(h,{modelValue:R.value,"onUpdate:modelValue":e[2]||(e[2]=l=>R.value=l),headers:O,items:T.value,loading:$.value,"items-per-page":p.value.itemsPerPage,page:p.value.page,total:C.value,class:"text-no-wrap","onUpdate:options":e[3]||(e[3]=l=>p.value=l)},{"item.price":t(({item:l})=>[a(L,{color:l.price>0?"success":"warning",size:"small"},{default:t(()=>[i(D(l.price||0)+" ريال ",1)]),_:2},1032,["color"])]),"item.quantity":t(({item:l})=>[a(L,{color:l.quantity>0?"primary":"error",size:"small"},{default:t(()=>[i(D(l.quantity||0),1)]),_:2},1032,["color"])]),"item.actions":t(({item:l})=>[a(v,{icon:"tabler-edit",variant:"text",size:"small",color:"primary",onClick:c=>H(l)},null,8,["onClick"]),a(v,{icon:"tabler-trash",variant:"text",size:"small",color:"error",onClick:c=>J(l)},null,8,["onClick"])]),_:1},8,["modelValue","items","loading","items-per-page","page","total"]),a(z,{modelValue:b.value,"onUpdate:modelValue":e[9]||(e[9]=l=>b.value=l),"max-width":"500px"},{default:t(()=>[a(S,null,{default:t(()=>[a(B,null,{default:t(()=>e[21]||(e[21]=[g("span",{class:"text-h5"},"إضافة مادة جديدة",-1)])),_:1}),a(w,null,{default:t(()=>[a(F,null,{default:t(()=>[a(E,null,{default:t(()=>[a(f,{cols:"12"},{default:t(()=>[a(y,{modelValue:s.value.name,"onUpdate:modelValue":e[4]||(e[4]=l=>s.value.name=l),label:"اسم المادة",required:""},null,8,["modelValue"])]),_:1}),a(f,{cols:"12"},{default:t(()=>[a(I,{modelValue:s.value.description,"onUpdate:modelValue":e[5]||(e[5]=l=>s.value.description=l),label:"الوصف",rows:"3"},null,8,["modelValue"])]),_:1}),a(f,{cols:"6"},{default:t(()=>[a(y,{modelValue:s.value.price,"onUpdate:modelValue":e[6]||(e[6]=l=>s.value.price=l),modelModifiers:{number:!0},label:"السعر",type:"number",min:"0",step:"0.01"},null,8,["modelValue"])]),_:1}),a(f,{cols:"6"},{default:t(()=>[a(y,{modelValue:s.value.quantity,"onUpdate:modelValue":e[7]||(e[7]=l=>s.value.quantity=l),modelModifiers:{number:!0},label:"الكمية",type:"number",min:"0"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),a(N,null,{default:t(()=>[a(M),a(v,{color:"blue-darken-1",variant:"text",onClick:e[8]||(e[8]=l=>b.value=!1)},{default:t(()=>e[22]||(e[22]=[i(" إلغاء ")])),_:1}),a(v,{color:"blue-darken-1",onClick:Z},{default:t(()=>e[23]||(e[23]=[i(" إضافة ")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(z,{modelValue:P.value,"onUpdate:modelValue":e[15]||(e[15]=l=>P.value=l),"max-width":"500px"},{default:t(()=>[a(S,null,{default:t(()=>[a(B,null,{default:t(()=>e[24]||(e[24]=[g("span",{class:"text-h5"},"تعديل المادة",-1)])),_:1}),a(w,null,{default:t(()=>[a(F,null,{default:t(()=>[a(E,null,{default:t(()=>[a(f,{cols:"12"},{default:t(()=>[a(y,{modelValue:r.value.name,"onUpdate:modelValue":e[10]||(e[10]=l=>r.value.name=l),label:"اسم المادة",required:""},null,8,["modelValue"])]),_:1}),a(f,{cols:"12"},{default:t(()=>[a(I,{modelValue:r.value.description,"onUpdate:modelValue":e[11]||(e[11]=l=>r.value.description=l),label:"الوصف",rows:"3"},null,8,["modelValue"])]),_:1}),a(f,{cols:"6"},{default:t(()=>[a(y,{modelValue:r.value.price,"onUpdate:modelValue":e[12]||(e[12]=l=>r.value.price=l),modelModifiers:{number:!0},label:"السعر",type:"number",min:"0",step:"0.01"},null,8,["modelValue"])]),_:1}),a(f,{cols:"6"},{default:t(()=>[a(y,{modelValue:r.value.quantity,"onUpdate:modelValue":e[13]||(e[13]=l=>r.value.quantity=l),modelModifiers:{number:!0},label:"الكمية",type:"number",min:"0"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),a(N,null,{default:t(()=>[a(M),a(v,{color:"blue-darken-1",variant:"text",onClick:e[14]||(e[14]=l=>P.value=!1)},{default:t(()=>e[25]||(e[25]=[i(" إلغاء ")])),_:1}),a(v,{color:"blue-darken-1",onClick:j},{default:t(()=>e[26]||(e[26]=[i(" تحديث ")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(z,{modelValue:k.value,"onUpdate:modelValue":e[17]||(e[17]=l=>k.value=l),"max-width":"400px"},{default:t(()=>[a(S,null,{default:t(()=>[a(B,{class:"text-h5"},{default:t(()=>e[27]||(e[27]=[i(" تأكيد الحذف ")])),_:1}),a(w,null,{default:t(()=>{var l;return[i(' هل أنت متأكد من حذف المادة "'+D((l=x.value)==null?void 0:l.name)+'"؟ ',1),e[28]||(e[28]=g("br",null,null,-1)),e[29]||(e[29]=g("strong",null,"لا يمكن التراجع عن هذا الإجراء.",-1))]}),_:1}),a(N,null,{default:t(()=>[a(M),a(v,{color:"blue-darken-1",variant:"text",onClick:e[16]||(e[16]=l=>k.value=!1)},{default:t(()=>e[30]||(e[30]=[i(" إلغاء ")])),_:1}),a(v,{color:"error",onClick:G},{default:t(()=>e[31]||(e[31]=[i(" حذف ")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(ee,{modelValue:n.value,"onUpdate:modelValue":e[18]||(e[18]=l=>n.value=l),color:m.value,timeout:3e3},{default:t(()=>[i(D(d.value),1)]),_:1},8,["modelValue","color"])]),_:1}))}});export{Ze as default};
