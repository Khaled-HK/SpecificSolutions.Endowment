import{a$ as ee,r as n,G as te,c as F,o as C,b as t,e as l,d as i,f as I,l as le,ac as d,t as r,v as u,V as R,aX as G}from"./index-HAXSP913.js";import{$ as f}from"./api-D8tF8UkA.js";import{b as E,V as x,d as S}from"./VCard-D2JA4AmT.js";import{V as ae}from"./VDivider-DWzVCSwo.js";import{V as b}from"./VCardText-BH-9XFE8.js";import{V as T}from"./VTextField-Dk4aTvnR.js";import{V as z}from"./VChip-hlgDUXKV.js";import{V as oe}from"./VDataTable-C9xC1VPt.js";import{V as re}from"./VSkeletonLoader-BaHDZNgH.js";import{V as M}from"./VTooltip-CjpHMp1v.js";import{V as ie}from"./VAvatar-rXBq910H.js";import{V as O}from"./VForm-B8aqMCjq.js";import{V as X,a as U}from"./VRow-D-WQ3rzz.js";import{V as H}from"./VSelect-B2jdzs7s.js";import{V as N}from"./VSpacer-CRFMTN7t.js";import{V as q}from"./VDialog-DFxEt3Xf.js";import{_ as ne}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-9rIf2CJL.js";import"./VImg-19-9jxk0.js";/* empty css                   */import"./VCounter-BRAxYcMs.js";import"./VField-DKyThWVI.js";import"./form-DhXBopYm.js";import"./easing-CjukEv2V.js";import"./VInput-BcFLJ-wF.js";import"./forwardRefs-C-GTDzx5.js";import"./VSlideGroup-_SWOzRoE.js";import"./VPagination-CLcdAlyM.js";import"./VCheckboxBtn-CxN3bhUn.js";import"./VSelectionControl-B_YabqNW.js";import"./VTable-BLedbsy0.js";import"./filter-BFModbeT.js";import"./VOverlay-DcepxaBF.js";import"./delay-D77_bA3B.js";import"./lazy-BVp99W2x.js";import"./scopeId-CpPFb7me.js";/* empty css              */import"./VList-eLNL9IS9.js";import"./ssrBoot-BFDk1D4x.js";import"./dialog-transition-B3FWIg09.js";import"./VMenu-DyxfBKQE.js";const se={class:"d-flex gap-2"},de={class:"d-flex justify-space-between align-center mb-4"},ue={class:"text-caption text-medium-emphasis"},me={class:"d-flex align-center"},pe={class:"text-body-1 font-weight-medium"},ve={class:"text-caption text-medium-emphasis"},fe={class:"text-body-2",style:{"max-width":"350px"}},ye={key:1,class:"text-medium-emphasis"},ge={class:"d-flex gap-1 justify-center"},Ve={class:"text-center py-8"},ce=ee({__name:"regions",setup(xe){const P=n([]),A=n([]),D=n([]),$=n(!1),k=n(!1),y=n(!1),g=n(!1),V=n(!1),w=n(null),m=n([]),B=n(""),p=n({name:"",country:""}),s=n({id:0,key:"",value:"",name:"",description:""}),J=[{title:"ID",key:"key",sortable:!0,sticky:!0,width:100},{title:"Name",key:"value",sortable:!0,sticky:!0,width:250},{title:"Country",key:"description",sortable:!0,width:400},{title:"Actions",key:"actions",sortable:!1,sticky:!0,width:120,align:"center"}],v=n({page:1,itemsPerPage:10,sortBy:[{key:"key",order:"asc"}]}),c=async()=>{$.value=!0;try{const o=await f("/Region/GetRegions");P.value=o.data}catch(o){console.error("Error loading regions:",o)}finally{$.value=!1}},K=async()=>{k.value=!0;try{const o=await f("/City/filter?PageSize=100");A.value=o.data.items||[];const e=[...new Set(A.value.map(a=>a.country).filter(Boolean))];D.value=e.sort()}catch(o){console.error("Error loading cities:",o)}finally{k.value=!1}},L=async()=>{try{await f("/Region",{method:"POST",body:{name:p.value.name,country:p.value.country}}),y.value=!1,_(),c()}catch(o){console.error("Error adding region:",o)}},j=async()=>{try{await f(`/Region/${s.value.id}`,{method:"PUT",body:{id:s.value.id,name:s.value.name,country:s.value.country||s.value.description}}),g.value=!1,c()}catch(o){console.error("Error updating region:",o)}},Q=async()=>{if(w.value)try{await f(`/Region/${w.value.id}`,{method:"DELETE"}),V.value=!1,c()}catch(o){console.error("Error deleting region:",o)}},W=async()=>{if(m.value.length!==0)try{const o=m.value.map(e=>f(`/Region/${e.id}`,{method:"DELETE"}));await Promise.all(o),m.value=[],c()}catch(o){console.error("Error deleting selected regions:",o)}},Y=o=>{s.value={...o,country:o.country||o.description||""},g.value=!0},Z=o=>{w.value=o,V.value=!0},_=()=>{p.value={name:"",country:""}};return te(()=>{c(),K()}),(o,e)=>(C(),F("div",null,[t(x,null,{default:l(()=>[t(E,{class:"d-flex justify-space-between align-center pa-6"},{default:l(()=>[e[17]||(e[17]=i("span",{class:"text-h5"},"إدارة المناطق - جدول بأعمدة ثابتة",-1)),i("div",se,[m.value.length>0?(C(),I(d,{key:0,color:"error",variant:"outlined",onClick:W},{default:l(()=>[r(" حذف المحدد ("+u(m.value.length)+") ",1)]),_:1})):le("",!0),t(d,{color:"primary",onClick:e[0]||(e[0]=a=>y.value=!0)},{default:l(()=>e[16]||(e[16]=[r(" إضافة منطقة ")])),_:1})])]),_:1}),t(ae),t(b,null,{default:l(()=>[i("div",de,[t(T,{modelValue:B.value,"onUpdate:modelValue":e[1]||(e[1]=a=>B.value=a),"prepend-inner-icon":"mdi-magnify",label:"البحث في المناطق...",variant:"outlined",density:"compact",style:{"max-width":"300px"},"hide-details":""},null,8,["modelValue"]),t(z,{color:"success",variant:"tonal","prepend-icon":"mdi-table-column"},{default:l(()=>e[18]||(e[18]=[r(" الأعمدة الثابتة نشطة ✓ ")])),_:1}),i("div",ue," المجموع: "+u(P.value.length)+" منطقة ",1)]),t(oe,{modelValue:m.value,"onUpdate:modelValue":e[2]||(e[2]=a=>m.value=a),page:v.value.page,"onUpdate:page":e[3]||(e[3]=a=>v.value.page=a),"items-per-page":v.value.itemsPerPage,"onUpdate:itemsPerPage":e[4]||(e[4]=a=>v.value.itemsPerPage=a),"sort-by":v.value.sortBy,"onUpdate:sortBy":e[5]||(e[5]=a=>v.value.sortBy=a),headers:J,items:P.value,loading:$.value,search:B.value,class:"elevation-1 text-no-wrap fixed-columns-table","item-value":"id","show-select":"","fixed-header":"",height:"600",hover:"",density:"compact"},{"item.key":l(({item:a})=>[t(z,{color:"primary",variant:"tonal",size:"small",class:"font-weight-bold"},{default:l(()=>[r(" #"+u(a.key),1)]),_:2},1024)]),"item.value":l(({item:a})=>[i("div",me,[t(ie,{color:"primary",variant:"tonal",size:"32",class:"me-3"},{default:l(()=>[r(u(a.value.charAt(0).toUpperCase()),1)]),_:2},1024),i("div",null,[i("div",pe,u(a.value),1),i("div",ve," الرقم: "+u(a.key),1)])])]),"item.description":l(({item:a})=>[i("div",fe,[a.description?(C(),I(z,{key:0,color:"secondary",variant:"tonal",size:"small"},{default:l(()=>[r(u(a.description),1)]),_:2},1024)):(C(),F("span",ye," لا توجد دولة "))])]),"item.actions":l(({item:a})=>[i("div",ge,[t(d,{icon:"mdi-pencil",size:"small",color:"primary",variant:"text",onClick:h=>Y(a)},{default:l(()=>[t(R,null,{default:l(()=>e[19]||(e[19]=[r("mdi-pencil")])),_:1}),t(M,{activator:"parent",location:"top"},{default:l(()=>e[20]||(e[20]=[r(" تعديل ")])),_:1})]),_:2},1032,["onClick"]),t(d,{icon:"mdi-delete",size:"small",color:"error",variant:"text",onClick:h=>Z(a)},{default:l(()=>[t(R,null,{default:l(()=>e[21]||(e[21]=[r("mdi-delete")])),_:1}),t(M,{activator:"parent",location:"top"},{default:l(()=>e[22]||(e[22]=[r(" حذف ")])),_:1})]),_:2},1032,["onClick"])])]),loading:l(()=>[t(re,{class:"mx-auto","max-width":"100%",type:"table-row@10"})]),"no-data":l(()=>[i("div",Ve,[t(R,{size:"64",color:"grey-lighten-2",class:"mb-4"},{default:l(()=>e[23]||(e[23]=[r(" mdi-table-search ")])),_:1}),e[24]||(e[24]=i("div",{class:"text-h6 text-medium-emphasis"}," لا توجد مناطق ",-1)),e[25]||(e[25]=i("div",{class:"text-body-2 text-medium-emphasis"}," جرب تعديل البحث أو إضافة منطقة جديدة ",-1))])]),_:1},8,["modelValue","page","items-per-page","sort-by","items","loading","search"]),t(x,{class:"mt-4",color:"info",variant:"tonal"},{default:l(()=>[t(b,{class:"d-flex align-center gap-3"},{default:l(()=>[t(R,null,{default:l(()=>e[26]||(e[26]=[r("mdi-information")])),_:1}),e[27]||(e[27]=i("div",null,[i("div",{class:"text-body-2 font-weight-medium"}," الأعمدة الثابتة (Fixed Columns) "),i("div",{class:"text-caption"}," أعمدة الرقم والاسم والإجراءات ثابتة ولا تتحرك عند التمرير الأفقي. يتم عرض الدولة من قائمة المدن المتاحة مع إمكانية البحث. ")],-1))]),_:1})]),_:1})]),_:1})]),_:1}),t(q,{modelValue:y.value,"onUpdate:modelValue":e[9]||(e[9]=a=>y.value=a),"max-width":"600px",persistent:""},{default:l(()=>[t(x,null,{default:l(()=>[t(E,{class:"text-h6"},{default:l(()=>e[28]||(e[28]=[r("إضافة منطقة جديدة")])),_:1}),t(b,null,{default:l(()=>[t(O,{onSubmit:G(L,["prevent"])},{default:l(()=>[t(X,null,{default:l(()=>[t(U,{cols:"12"},{default:l(()=>[t(T,{modelValue:p.value.name,"onUpdate:modelValue":e[6]||(e[6]=a=>p.value.name=a),label:"اسم المنطقة",variant:"outlined",required:"",rules:[a=>!!a||"اسم المنطقة مطلوب"]},null,8,["modelValue","rules"])]),_:1}),t(U,{cols:"12"},{default:l(()=>[t(H,{modelValue:p.value.country,"onUpdate:modelValue":e[7]||(e[7]=a=>p.value.country=a),label:"الدولة",variant:"outlined",items:D.value,loading:k.value,searchable:"",filterable:"",clearable:"","no-data-text":"لا توجد دول متاحة",required:"",rules:[a=>!!a||"الدولة مطلوبة"],"prepend-inner-icon":"mdi-magnify",placeholder:"ابحث عن دولة..."},null,8,["modelValue","items","loading","rules"])]),_:1})]),_:1})]),_:1})]),_:1}),t(S,null,{default:l(()=>[t(N),t(d,{color:"grey-darken-1",variant:"text",onClick:e[8]||(e[8]=a=>y.value=!1)},{default:l(()=>e[29]||(e[29]=[r(" إلغاء ")])),_:1}),t(d,{color:"primary",variant:"flat",onClick:L},{default:l(()=>e[30]||(e[30]=[r(" حفظ ")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(q,{modelValue:g.value,"onUpdate:modelValue":e[13]||(e[13]=a=>g.value=a),"max-width":"600px",persistent:""},{default:l(()=>[t(x,null,{default:l(()=>[t(E,{class:"text-h6"},{default:l(()=>e[31]||(e[31]=[r("تعديل المنطقة")])),_:1}),t(b,null,{default:l(()=>[t(O,{onSubmit:G(j,["prevent"])},{default:l(()=>[t(X,null,{default:l(()=>[t(U,{cols:"12"},{default:l(()=>[t(T,{modelValue:s.value.name,"onUpdate:modelValue":e[10]||(e[10]=a=>s.value.name=a),label:"اسم المنطقة",variant:"outlined",required:"",rules:[a=>!!a||"اسم المنطقة مطلوب"]},null,8,["modelValue","rules"])]),_:1}),t(U,{cols:"12"},{default:l(()=>[t(H,{modelValue:s.value.country,"onUpdate:modelValue":e[11]||(e[11]=a=>s.value.country=a),label:"الدولة",variant:"outlined",items:D.value,loading:k.value,searchable:"",filterable:"",clearable:"","no-data-text":"لا توجد دول متاحة",required:"",rules:[a=>!!a||"الدولة مطلوبة"],"prepend-inner-icon":"mdi-magnify",placeholder:"ابحث عن دولة..."},null,8,["modelValue","items","loading","rules"])]),_:1})]),_:1})]),_:1})]),_:1}),t(S,null,{default:l(()=>[t(N),t(d,{color:"grey-darken-1",variant:"text",onClick:e[12]||(e[12]=a=>g.value=!1)},{default:l(()=>e[32]||(e[32]=[r(" إلغاء ")])),_:1}),t(d,{color:"primary",variant:"flat",onClick:j},{default:l(()=>e[33]||(e[33]=[r(" تحديث ")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(q,{modelValue:V.value,"onUpdate:modelValue":e[15]||(e[15]=a=>V.value=a),"max-width":"400px"},{default:l(()=>[t(x,null,{default:l(()=>[t(E,{class:"text-h6"},{default:l(()=>e[34]||(e[34]=[r("تأكيد الحذف")])),_:1}),t(b,null,{default:l(()=>{var a;return[e[35]||(e[35]=r(' هل أنت متأكد من حذف المنطقة "')),i("strong",null,u((a=w.value)==null?void 0:a.value),1),e[36]||(e[36]=r('"؟ ')),e[37]||(e[37]=i("br",null,null,-1)),e[38]||(e[38]=i("span",{class:"text-error"},"لا يمكن التراجع عن هذا الإجراء.",-1))]}),_:1}),t(S,null,{default:l(()=>[t(N),t(d,{color:"grey-darken-1",variant:"text",onClick:e[14]||(e[14]=a=>V.value=!1)},{default:l(()=>e[39]||(e[39]=[r(" إلغاء ")])),_:1}),t(d,{color:"error",variant:"flat",onClick:Q},{default:l(()=>e[40]||(e[40]=[r(" حذف ")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}}),nt=ne(ce,[["__scopeId","data-v-15cb3dd6"]]);export{nt as default};
