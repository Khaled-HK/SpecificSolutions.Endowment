import{_ as $}from"./AppTextField-DtviL4Ic.js";import{aZ as N,r as h,i as O,j as z,br as G,a as Z,c as H,o as J,b as t,e as r,d as o,m as a,E as V,t as R,s as u,aV as K,aa as Q,F as X,b5 as b,aU as Y}from"./index-Bg4xuB1X.js";import{_ as ee}from"./AuthProvider-C3cmwabT.js";import{u as W}from"./useGenerateImageVariant-5ej4SCY6.js";import{a as te,b as se,c as re,d as ae}from"./auth-v2-login-illustration-light-8U3Ay0LB.js";import{a as oe,b as le}from"./misc-mask-light-CdCn4Q-o.js";import{V as ie}from"./VNodeRenderer-CpFqrfaa.js";import{u as ne}from"./useAbility-3Qx2c-C2.js";import{u as ue}from"./useFormValidation-BDZm5KGL.js";import{$ as me}from"./api-CtflMH2I.js";import{a as d,V as A}from"./VRow-BAQcKL2W.js";import{V as de}from"./VImg-NlJe-KFk.js";import{V as fe}from"./VCard-DDR_Ypqe.js";import{V as _}from"./VCardText-s50m09-4.js";import{V as pe}from"./VAlert-EJXBu8ko.js";import{V as ce}from"./VForm-BSFgP32H.js";import{V as ge}from"./VCheckbox-FBPOCfUZ.js";import{V as C}from"./VDivider-DifrbBpe.js";import"./form-Cuh6vgJQ.js";import"./VTextField-BHcrK3Dr.js";/* empty css                   */import"./VCounter-DeZ2K8Z1.js";import"./VField-vHjrVG5U.js";import"./easing-CjukEv2V.js";import"./VInput-jwilm1jM.js";import"./forwardRefs-C-GTDzx5.js";import"./index-9rIf2CJL.js";/* empty css              */import"./VAvatar-BsFM-TZJ.js";import"./VCheckboxBtn-DUP9cNAP.js";import"./VSelectionControl-C-J5k8Iq.js";const he={class:"auth-logo d-flex align-center gap-x-3"},Ve={class:"auth-title"},be={class:"position-relative bg-background w-100 me-0"},_e={class:"d-flex align-center justify-center w-100 h-100",style:{"padding-inline":"6.25rem"}},we=["src"],ve={class:"text-h4 mb-1"},xe={class:"text-capitalize"},ye={class:"d-flex align-center flex-wrap justify-space-between my-6"},st=N({__name:"login",setup(ke){const E=W(ae,re,se,te,!0),j=W(le,oe),p=h(!1),w=O(),B=z(),D=ne(),{validationState:m,setErrorsFromResponse:L,clearErrors:T,hasErrors:F,setFieldTouched:c,validateRequired:v,validateEmail:I,addError:g}=ue(),P=h(),i=G({email:"admin@demo.com",password:"admin"}),x=h(!1),S=async()=>{try{const e=(await me("/Auth/login",{method:"POST",body:{email:i.email,password:i.password},onResponseError({response:l}){l._data.errors?L(l._data):g("email","ÙØ´Ù„ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„. ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø§Ø¹ØªÙ…Ø§Ø¯.")}})).data;if(b("accessToken").value=e.token,b("userData").value=e,!e.permissions){console.error("User object does not have permissions:",e),g("email","ÙØ´Ù„ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„: Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ ØµÙ„Ø§Ø­ÙŠØ§Øª.");return}const n=[];n.push({action:"read",subject:"Auth"},{action:"write",subject:"Auth"},{action:"delete",subject:"Auth"},{action:"View",subject:"Dashboard"}),e.permissions.forEach(l=>{const y=q(l),k=M(l);y&&k&&n.push({action:y,subject:k})}),console.log("CASL Rules Ø§Ù„Ù…Ø­Ø¯Ø«Ø©:",n),console.log("User permissions Ù…Ù† Backend:",e.permissions),b("userAbilityRules").value=n,D.update(n);const f=w.query.to?String(w.query.to):"/dashboard";console.log("Navigating to:",f),await Y(()=>{B.replace(f)})}catch(s){console.error("Login error:",s),g("email","ÙØ´Ù„ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.")}},U=async()=>{T();let s=!0;v(i.email,"email","Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ù…Ø·Ù„ÙˆØ¨")&&I(i.email,"email","Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ ØºÙŠØ± ØµØ­ÙŠØ­")||(s=!1),v(i.password,"password","ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ù…Ø·Ù„ÙˆØ¨Ø©")||(s=!1),c("email"),c("password"),s&&await S()};function q(s){return s.endsWith("_View")?"View":s.endsWith("_Add")?"Add":s.endsWith("_Edit")?"Edit":s.endsWith("_Delete")?"Delete":null}function M(s){return s.startsWith("Account_")?"Account":s.startsWith("User_")?"User":s.startsWith("Role_")?"Role":s.startsWith("Decision_")?"Decision":s.startsWith("Request_")?"Request":s.startsWith("Office_")?"Office":s.startsWith("Endowment_")?"Endowment":s.startsWith("City_")?"City":s.startsWith("Region_")?"Region":s.startsWith("Building_")?"Building":s.startsWith("Mosque_")?"Mosque":null}return(s,e)=>{const n=Z("RouterLink"),f=$;return J(),H(X,null,[t(n,{to:"/"},{default:r(()=>[o("div",he,[t(a(ie),{nodes:a(V).app.logo},null,8,["nodes"]),o("h1",Ve,R(a(V).app.title),1)])]),_:1}),t(A,{"no-gutters":"",class:"auth-wrapper bg-surface"},{default:r(()=>[t(d,{md:"8",class:"d-none d-md-flex"},{default:r(()=>[o("div",be,[o("div",_e,[t(de,{"max-width":"613",src:a(E),class:"auth-illustration mt-16 mb-2"},null,8,["src"])]),o("img",{class:"auth-footer-mask",src:a(j),alt:"auth-footer-mask",height:"280",width:"100"},null,8,we)])]),_:1}),t(d,{cols:"12",md:"4",class:"auth-card-v2 d-flex align-center justify-center"},{default:r(()=>[t(fe,{flat:"","max-width":500,class:"mt-12 mt-sm-0 pa-4"},{default:r(()=>[t(_,null,{default:r(()=>[o("h4",ve,[e[6]||(e[6]=u(" Welcome to ")),o("span",xe,R(a(V).app.title),1),e[7]||(e[7]=u("! ðŸ‘‹ðŸ» "))]),e[8]||(e[8]=o("p",{class:"mb-0"}," Please sign-in to your account and start the adventure ",-1))]),_:1}),t(_,null,{default:r(()=>[t(pe,{color:"primary",variant:"tonal"},{default:r(()=>e[9]||(e[9]=[o("p",{class:"text-sm mb-2"},[u(" Admin Email: "),o("strong",null,"admin@demo.com"),u(" / Pass: "),o("strong",null,"admin")],-1),o("p",{class:"text-sm mb-0"},[u(" Client Email: "),o("strong",null,"client@demo.com"),u(" / Pass: "),o("strong",null,"client")],-1)])),_:1})]),_:1}),t(_,null,{default:r(()=>[t(a(ce),{ref_key:"refVForm",ref:P,onSubmit:K(U,["prevent"])},{default:r(()=>[t(A,null,{default:r(()=>[t(d,{cols:"12"},{default:r(()=>[t(f,{modelValue:i.email,"onUpdate:modelValue":e[0]||(e[0]=l=>i.email=l),label:"Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ",placeholder:"johndoe@email.com",type:"email",autofocus:"",error:a(m).errors.email&&a(m).errors.email.length>0&&a(m).touched.email,"error-messages":a(m).errors.email||[],onBlur:e[1]||(e[1]=l=>a(c)("email"))},null,8,["modelValue","error","error-messages"])]),_:1}),t(d,{cols:"12"},{default:r(()=>[t(f,{modelValue:i.password,"onUpdate:modelValue":e[2]||(e[2]=l=>i.password=l),label:"ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±",placeholder:"Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·",type:p.value?"text":"password",autocomplete:"password",error:a(m).errors.password&&a(m).errors.password.length>0&&a(m).touched.password,"error-messages":a(m).errors.password||[],"append-inner-icon":p.value?"tabler-eye-off":"tabler-eye","onClick:appendInner":e[3]||(e[3]=l=>p.value=!p.value),onBlur:e[4]||(e[4]=l=>a(c)("password"))},null,8,["modelValue","type","error","error-messages","append-inner-icon"]),o("div",ye,[t(ge,{modelValue:x.value,"onUpdate:modelValue":e[5]||(e[5]=l=>x.value=l),label:"Remember me"},null,8,["modelValue"]),t(n,{class:"text-primary ms-2 mb-1",to:{name:"forgot-password"}},{default:r(()=>e[10]||(e[10]=[u(" Forgot Password? ")])),_:1})]),t(Q,{block:"",type:"submit",disabled:a(F)},{default:r(()=>e[11]||(e[11]=[u(" ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ ")])),_:1},8,["disabled"])]),_:1}),t(d,{cols:"12",class:"text-center"},{default:r(()=>[e[13]||(e[13]=o("span",null,"New on our platform?",-1)),t(n,{class:"text-primary ms-1",to:{name:"register"}},{default:r(()=>e[12]||(e[12]=[u(" Create an account ")])),_:1})]),_:1}),t(d,{cols:"12",class:"d-flex align-center"},{default:r(()=>[t(C),e[14]||(e[14]=o("span",{class:"mx-4"},"or",-1)),t(C)]),_:1}),t(d,{cols:"12",class:"text-center"},{default:r(()=>[t(ee)]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})]),_:1})]),_:1})],64)}}});export{st as default};
