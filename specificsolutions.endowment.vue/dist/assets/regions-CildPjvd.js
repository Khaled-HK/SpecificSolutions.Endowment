import{a$ as ie,r as s,w as G,R as ne,G as re,c as X,o as z,b as t,e as l,d as o,f as H,l as se,ac as p,t as i,v as d,V,aX as J}from"./index-CZFANRWF.js";import{$ as b}from"./api-BYjoE4XN.js";import{b as $,V as w,d as A}from"./VCard-npYMU2FV.js";import{V as de}from"./VDivider-C1QiU0DI.js";import{V as P}from"./VCardText-CukUF6yv.js";import{V as L}from"./VTextField-B1Iksyua.js";import{V as I}from"./VChip-BBHnIl2S.js";import{V as ue}from"./VDataTable-BAm30qax.js";import{V as me}from"./VSkeletonLoader-Bd86rymF.js";import{V as K}from"./VTooltip-q4zSlYyv.js";import{V as pe}from"./VAvatar-DCijFEd1.js";import{V as Q}from"./VForm-D2O8hXLW.js";import{V as W,a as k}from"./VRow-CDz6rRIv.js";import{V as D}from"./VAutocomplete-BPE4jQMg.js";import{V as j}from"./VSpacer-gaGd2s3O.js";import{V as F}from"./VDialog-C9mVVo53.js";import{_ as ve}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-9rIf2CJL.js";import"./VImg-BRzAIL0t.js";/* empty css                   */import"./VCounter-BGnM0uc7.js";import"./VField-BIfacFIe.js";import"./form-BvEzv23f.js";import"./easing-CjukEv2V.js";import"./VInput-BqDXEN0N.js";import"./forwardRefs-C-GTDzx5.js";import"./VSlideGroup-DAUUpEIg.js";import"./VPagination-B0wYRW_r.js";import"./VSelect-BvFZb9sZ.js";import"./VList-Byb6sNAj.js";import"./ssrBoot-8U3icAo_.js";import"./dialog-transition-DkOpT4ku.js";import"./VMenu-BlIMkME8.js";import"./VOverlay-NRX_hWfX.js";import"./delay-Bu0Pbqa2.js";import"./lazy-BuUVLOop.js";import"./scopeId-DrBTtIIF.js";import"./VCheckboxBtn-BFRdydM0.js";import"./VSelectionControl-B0NqBUPU.js";import"./VTable-CuubFdxy.js";import"./filter-DlfbYVwO.js";/* empty css              */const fe={class:"d-flex gap-2"},ge={class:"d-flex justify-space-between align-center mb-4"},ce={class:"d-flex align-center gap-4"},ye={class:"d-flex align-center"},Ve={class:"text-body-1 font-weight-medium"},xe={class:"text-body-2",style:{"max-width":"350px"}},be={key:1,class:"text-medium-emphasis"},we={class:"d-flex gap-1 justify-center"},Pe={class:"text-center py-8"},ke={class:"d-flex justify-space-between align-center"},Ce={class:"d-flex align-center gap-4"},Re={class:"d-flex align-center gap-2"},Ue={class:"text-caption"},Ie={class:"d-flex align-center gap-2"},Ee={class:"text-caption"},Se={class:"d-flex align-center gap-2"},Te=ie({__name:"regions",setup(ze){const B=s([]),E=s([]),q=s([]),N=s(!1),x=s(!1),g=s(0),c=s(0),C=s(!1),R=s(!1),U=s(!1),S=s(null),y=s([]),T=s(""),m=s({name:"",country:"",cityId:""}),u=s({id:0,key:"",value:"",name:"",description:"",cityId:""}),Y=[{title:"Name",key:"name",sortable:!0,sticky:!0,width:250},{title:"Country",key:"country",sortable:!0,width:400},{title:"Actions",key:"actions",sortable:!1,sticky:!0,width:120,align:"center"}],r=s({page:1,itemsPerPage:10,sortBy:[{key:"name",order:"asc"}]}),v=async()=>{N.value=!0;try{const n=new URLSearchParams({PageNumber:r.value.page.toString(),PageSize:r.value.itemsPerPage.toString(),SearchTerm:T.value||""}),e=await b(`/Region/filter?${n}`);B.value=e.data.items||[],e.data&&(g.value=e.data.totalCount||0,c.value=e.data.totalPages||0,r.value.page>c.value&&c.value>0&&(r.value.page=c.value,await v()))}catch(n){console.error("Error loading regions:",n),B.value=[],g.value=0,c.value=0}finally{N.value=!1}},Z=async()=>{x.value=!0;try{const n=await b("/City/filter?PageSize=100");E.value=n.data.items||[];const e=[...new Set(E.value.map(a=>a.country).filter(Boolean))];q.value=e.sort()}catch(n){console.error("Error loading cities:",n)}finally{x.value=!1}},M=async()=>{try{await b("/Region",{method:"POST",body:{name:m.value.name,country:m.value.country,cityId:m.value.cityId}}),C.value=!1,ae(),v()}catch(n){console.error("Error adding region:",n)}},O=async()=>{try{await b(`/Region/${u.value.id}`,{method:"PUT",body:{id:u.value.id,name:u.value.name,country:u.value.country||u.value.description,cityId:u.value.cityId}}),R.value=!1,v()}catch(n){console.error("Error updating region:",n)}},h=async()=>{if(S.value)try{await b(`/Region/${S.value.id}`,{method:"DELETE"}),U.value=!1,v()}catch(n){console.error("Error deleting region:",n)}},ee=async()=>{if(y.value.length!==0)try{const n=y.value.map(e=>b(`/Region/${e.id}`,{method:"DELETE"}));await Promise.all(n),y.value=[],v()}catch(n){console.error("Error deleting selected regions:",n)}},te=n=>{u.value={...n,country:n.country||n.description||""},R.value=!0},le=n=>{S.value=n,U.value=!0},ae=()=>{m.value={name:"",country:"",cityId:""}};G([()=>r.value.page,()=>r.value.itemsPerPage],()=>{v()},{immediate:!1});const f=ne(()=>{const n=(r.value.page-1)*r.value.itemsPerPage+1,e=Math.min(r.value.page*r.value.itemsPerPage,g.value);return{start:n,end:e,total:g.value,currentPage:r.value.page,totalPages:c.value}});let _=null;return G(T,()=>{r.value.page=1,_&&clearTimeout(_),_=setTimeout(()=>{v()},500)},{immediate:!1}),re(()=>{v(),Z()}),(n,e)=>(z(),X("div",null,[t(w,null,{default:l(()=>[t($,{class:"d-flex justify-space-between align-center pa-6"},{default:l(()=>[e[19]||(e[19]=o("span",{class:"text-h5"},"إدارة المناطق - جدول بأعمدة ثابتة",-1)),o("div",fe,[y.value.length>0?(z(),H(p,{key:0,color:"error",variant:"outlined",onClick:ee},{default:l(()=>[i(" حذف المحدد ("+d(y.value.length)+") ",1)]),_:1})):se("",!0),t(p,{color:"primary",onClick:e[0]||(e[0]=a=>C.value=!0)},{default:l(()=>e[18]||(e[18]=[i(" إضافة منطقة ")])),_:1})])]),_:1}),t(de),t(P,null,{default:l(()=>[o("div",ge,[t(L,{modelValue:T.value,"onUpdate:modelValue":e[1]||(e[1]=a=>T.value=a),"prepend-inner-icon":"mdi-magnify",label:"البحث في المناطق...",variant:"outlined",density:"compact",style:{"max-width":"300px"},"hide-details":"",clearable:"",placeholder:"ابحث عن منطقة..."},null,8,["modelValue"]),t(I,{color:"success",variant:"tonal","prepend-icon":"mdi-table-column"},{default:l(()=>e[20]||(e[20]=[i(" الأعمدة الثابتة نشطة ✓ ")])),_:1}),o("div",ce,[t(I,{color:"info",variant:"tonal",size:"small"},{default:l(()=>[i(" المجموع: "+d(g.value)+" منطقة ",1)]),_:1}),t(I,{color:"primary",variant:"tonal",size:"small"},{default:l(()=>[i(" الصفحة "+d(r.value.page)+" من "+d(c.value),1)]),_:1}),t(I,{color:"success",variant:"tonal",size:"small"},{default:l(()=>[i(" عرض "+d(f.value.start)+"-"+d(f.value.end)+" من "+d(f.value.total),1)]),_:1})])]),t(ue,{modelValue:y.value,"onUpdate:modelValue":e[2]||(e[2]=a=>y.value=a),page:r.value.page,"onUpdate:page":e[3]||(e[3]=a=>r.value.page=a),"items-per-page":r.value.itemsPerPage,"onUpdate:itemsPerPage":e[4]||(e[4]=a=>r.value.itemsPerPage=a),"sort-by":r.value.sortBy,"onUpdate:sortBy":e[5]||(e[5]=a=>r.value.sortBy=a),headers:Y,items:B.value,loading:N.value,class:"elevation-1 text-no-wrap fixed-columns-table","item-value":"id","show-select":"","fixed-header":"",height:"600",hover:"",density:"compact","items-per-page-options":[5,10,25,50,100],"show-current-page":"","show-items-per-page":"","items-length":g.value,"server-items-length":g.value,"footer-props":{"items-per-page-options":[5,10,25,50,100],"items-per-page-text":"عناصر في الصفحة:","page-text":"{0}-{1} من {2}","first-icon":"mdi-page-first","last-icon":"mdi-page-last","prev-icon":"mdi-chevron-left","next-icon":"mdi-chevron-right"},"loading-text":"جاري التحميل...","no-data-text":"لا توجد بيانات","no-results-text":"لا توجد نتائج للبحث"},{"item.name":l(({item:a})=>[o("div",ye,[t(pe,{color:"primary",variant:"tonal",size:"32",class:"me-3"},{default:l(()=>[i(d(a.name.charAt(0).toUpperCase()),1)]),_:2},1024),o("div",null,[o("div",Ve,d(a.name),1)])])]),"item.country":l(({item:a})=>[o("div",xe,[a.country?(z(),H(I,{key:0,color:"secondary",variant:"tonal",size:"small"},{default:l(()=>[i(d(a.country),1)]),_:2},1024)):(z(),X("span",be," لا توجد دولة "))])]),"item.actions":l(({item:a})=>[o("div",we,[t(p,{icon:"mdi-pencil",size:"small",color:"primary",variant:"text",onClick:oe=>te(a)},{default:l(()=>[t(V,null,{default:l(()=>e[21]||(e[21]=[i("mdi-pencil")])),_:1}),t(K,{activator:"parent",location:"top"},{default:l(()=>e[22]||(e[22]=[i(" تعديل ")])),_:1})]),_:2},1032,["onClick"]),t(p,{icon:"mdi-delete",size:"small",color:"error",variant:"text",onClick:oe=>le(a)},{default:l(()=>[t(V,null,{default:l(()=>e[23]||(e[23]=[i("mdi-delete")])),_:1}),t(K,{activator:"parent",location:"top"},{default:l(()=>e[24]||(e[24]=[i(" حذف ")])),_:1})]),_:2},1032,["onClick"])])]),loading:l(()=>[t(me,{class:"mx-auto","max-width":"100%",type:"table-row@10"})]),"no-data":l(()=>[o("div",Pe,[t(V,{size:"64",color:"grey-lighten-2",class:"mb-4"},{default:l(()=>e[25]||(e[25]=[i(" mdi-table-search ")])),_:1}),e[26]||(e[26]=o("div",{class:"text-h6 text-medium-emphasis"}," لا توجد مناطق ",-1)),e[27]||(e[27]=o("div",{class:"text-body-2 text-medium-emphasis"}," جرب تعديل البحث أو إضافة منطقة جديدة ",-1))])]),"footer.prepend":l(()=>e[28]||(e[28]=[o("div",{class:"d-flex align-center gap-2"},[o("span",{class:"text-caption"},"عناصر في الصفحة:")],-1)])),_:1},8,["modelValue","page","items-per-page","sort-by","items","loading","items-length","server-items-length"]),t(w,{class:"mt-4",color:"surface",variant:"outlined"},{default:l(()=>[t(P,{class:"pa-4"},{default:l(()=>[o("div",ke,[o("div",Ce,[o("div",Re,[t(V,{size:"16",color:"info"},{default:l(()=>e[29]||(e[29]=[i("mdi-information")])),_:1}),o("span",Ue,"عرض "+d(f.value.start)+"-"+d(f.value.end)+" من "+d(f.value.total)+" منطقة",1)]),o("div",Ie,[t(V,{size:"16",color:"primary"},{default:l(()=>e[30]||(e[30]=[i("mdi-page-layout-body")])),_:1}),o("span",Ee,"الصفحة "+d(f.value.currentPage)+" من "+d(f.value.totalPages),1)])]),o("div",Se,[t(V,{size:"16",color:"success"},{default:l(()=>e[31]||(e[31]=[i("mdi-check-circle")])),_:1}),e[32]||(e[32]=o("span",{class:"text-caption"},"الـ Pagination يعمل بشكل مثالي ✓",-1))])])]),_:1})]),_:1}),t(w,{class:"mt-4",color:"info",variant:"tonal"},{default:l(()=>[t(P,{class:"d-flex align-center gap-3"},{default:l(()=>[t(V,null,{default:l(()=>e[33]||(e[33]=[i("mdi-information")])),_:1}),e[34]||(e[34]=o("div",null,[o("div",{class:"text-body-2 font-weight-medium"}," الأعمدة الثابتة (Fixed Columns) مع البحث التلقائي "),o("div",{class:"text-caption"}," أعمدة الرقم والاسم والإجراءات ثابتة ولا تتحرك عند التمرير الأفقي. يمكن البحث في الجدول والكتابة في قائمة الدول المنسدلة. ")],-1))]),_:1})]),_:1})]),_:1})]),_:1}),t(F,{modelValue:C.value,"onUpdate:modelValue":e[10]||(e[10]=a=>C.value=a),"max-width":"600px",persistent:""},{default:l(()=>[t(w,null,{default:l(()=>[t($,{class:"text-h6"},{default:l(()=>e[35]||(e[35]=[i("إضافة منطقة جديدة")])),_:1}),t(P,null,{default:l(()=>[t(Q,{onSubmit:J(M,["prevent"])},{default:l(()=>[t(W,null,{default:l(()=>[t(k,{cols:"12"},{default:l(()=>[t(L,{modelValue:m.value.name,"onUpdate:modelValue":e[6]||(e[6]=a=>m.value.name=a),label:"اسم المنطقة",variant:"outlined",required:"",rules:[a=>!!a||"اسم المنطقة مطلوب"]},null,8,["modelValue","rules"])]),_:1}),t(k,{cols:"12"},{default:l(()=>[t(D,{modelValue:m.value.cityId,"onUpdate:modelValue":e[7]||(e[7]=a=>m.value.cityId=a),label:"المدينة",variant:"outlined",items:E.value,"item-title":"name","item-value":"id",loading:x.value,clearable:"","no-data-text":"لا توجد مدن متاحة",required:"",rules:[a=>!!a||"المدينة مطلوبة"],"prepend-inner-icon":"mdi-city",placeholder:"اختر المدينة...","hide-no-data":""},null,8,["modelValue","items","loading","rules"])]),_:1}),t(k,{cols:"12"},{default:l(()=>[t(D,{modelValue:m.value.country,"onUpdate:modelValue":e[8]||(e[8]=a=>m.value.country=a),label:"الدولة",variant:"outlined",items:q.value,loading:x.value,clearable:"","no-data-text":"لا توجد دول متاحة",required:"",rules:[a=>!!a||"الدولة مطلوبة"],"prepend-inner-icon":"mdi-magnify",placeholder:"ابحث عن دولة...","hide-no-data":""},null,8,["modelValue","items","loading","rules"])]),_:1})]),_:1})]),_:1})]),_:1}),t(A,null,{default:l(()=>[t(j),t(p,{color:"grey-darken-1",variant:"text",onClick:e[9]||(e[9]=a=>C.value=!1)},{default:l(()=>e[36]||(e[36]=[i(" إلغاء ")])),_:1}),t(p,{color:"primary",variant:"flat",onClick:M},{default:l(()=>e[37]||(e[37]=[i(" حفظ ")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(F,{modelValue:R.value,"onUpdate:modelValue":e[15]||(e[15]=a=>R.value=a),"max-width":"600px",persistent:""},{default:l(()=>[t(w,null,{default:l(()=>[t($,{class:"text-h6"},{default:l(()=>e[38]||(e[38]=[i("تعديل المنطقة")])),_:1}),t(P,null,{default:l(()=>[t(Q,{onSubmit:J(O,["prevent"])},{default:l(()=>[t(W,null,{default:l(()=>[t(k,{cols:"12"},{default:l(()=>[t(L,{modelValue:u.value.name,"onUpdate:modelValue":e[11]||(e[11]=a=>u.value.name=a),label:"اسم المنطقة",variant:"outlined",required:"",rules:[a=>!!a||"اسم المنطقة مطلوب"]},null,8,["modelValue","rules"])]),_:1}),t(k,{cols:"12"},{default:l(()=>[t(D,{modelValue:u.value.cityId,"onUpdate:modelValue":e[12]||(e[12]=a=>u.value.cityId=a),label:"المدينة",variant:"outlined",items:E.value,"item-title":"name","item-value":"id",loading:x.value,clearable:"","no-data-text":"لا توجد مدن متاحة",required:"",rules:[a=>!!a||"المدينة مطلوبة"],"prepend-inner-icon":"mdi-city",placeholder:"اختر المدينة...","hide-no-data":""},null,8,["modelValue","items","loading","rules"])]),_:1}),t(k,{cols:"12"},{default:l(()=>[t(D,{modelValue:u.value.country,"onUpdate:modelValue":e[13]||(e[13]=a=>u.value.country=a),label:"الدولة",variant:"outlined",items:q.value,loading:x.value,clearable:"","no-data-text":"لا توجد دول متاحة",required:"",rules:[a=>!!a||"الدولة مطلوبة"],"prepend-inner-icon":"mdi-magnify",placeholder:"ابحث عن دولة...","hide-no-data":""},null,8,["modelValue","items","loading","rules"])]),_:1})]),_:1})]),_:1})]),_:1}),t(A,null,{default:l(()=>[t(j),t(p,{color:"grey-darken-1",variant:"text",onClick:e[14]||(e[14]=a=>R.value=!1)},{default:l(()=>e[39]||(e[39]=[i(" إلغاء ")])),_:1}),t(p,{color:"primary",variant:"flat",onClick:O},{default:l(()=>e[40]||(e[40]=[i(" تحديث ")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(F,{modelValue:U.value,"onUpdate:modelValue":e[17]||(e[17]=a=>U.value=a),"max-width":"400px"},{default:l(()=>[t(w,null,{default:l(()=>[t($,{class:"text-h6"},{default:l(()=>e[41]||(e[41]=[i("تأكيد الحذف")])),_:1}),t(P,null,{default:l(()=>{var a;return[e[42]||(e[42]=i(' هل أنت متأكد من حذف المنطقة "')),o("strong",null,d((a=S.value)==null?void 0:a.value),1),e[43]||(e[43]=i('"؟ ')),e[44]||(e[44]=o("br",null,null,-1)),e[45]||(e[45]=o("span",{class:"text-error"},"لا يمكن التراجع عن هذا الإجراء.",-1))]}),_:1}),t(A,null,{default:l(()=>[t(j),t(p,{color:"grey-darken-1",variant:"text",onClick:e[16]||(e[16]=a=>U.value=!1)},{default:l(()=>e[46]||(e[46]=[i(" إلغاء ")])),_:1}),t(p,{color:"error",variant:"flat",onClick:h},{default:l(()=>e[47]||(e[47]=[i(" حذف ")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}}),bt=ve(Te,[["__scopeId","data-v-3a1c642b"]]);export{bt as default};
